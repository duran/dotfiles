#!/bin/sh
set -o errexit
set -o nounset
#set -o xtrace
shopt -s lastpipe

grep -Po '[a-z]+(?=\))' "$0" | rofi -dmenu -e 'pottao' | read -r ACTION

test "$( cat /proc/1/comm )" == systemd && logind=systemctl || logind=loginctl

case "$ACTION" in
    lock)
        # for some reason blurlock does not work for me
        xsecurelock
        break
        ;;
    logout)
        i3-msg exit
        break
        ;;
    suspend)
        $logind suspend
        break
        ;;
    hibernate)
        $logind hibernate
        break
        ;;
    reboot)
        $logind reboot
        break
        ;;
    shutdown)
        $logind poweroff
        break
        ;;
    *)
        notify-send "Try again with: lock | logout | suspend | hibernate | reboot | shutdown"
        exit 2
esac

exit 0
